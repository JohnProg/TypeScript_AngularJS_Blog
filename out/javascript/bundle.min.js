var moduleFirstDemo;!function(t){"user strict";function o(t){t.when("/",{templateUrl:"app/views/postList.html",controller:"PostListController",controllerAs:"vm"}).when("/posts/new",{templateUrl:"app/views/newPost.html",controller:"PostListController",controllerAs:"vm"}).when("/posts/:id",{templateUrl:"app/views/viewPost.html",controller:"PostViewController",controllerAs:"vm"}).when("/admin/posts/:id",{templateUrl:"app/views/viewPost.html",controller:"PostViewController",controllerAs:"vm"}).when("/acerca",{templateUrl:"app/views/acerca.html"}).when("/admin/posts",{templateUrl:"app/views/admin/postList.html"}).otherwise("/")}var e=angular.module("demoModule",["ngRoute","common.services","ngSanitize"]);e.config(o),o.$inject=["$routeProvider"]}(moduleFirstDemo||(moduleFirstDemo={}));var moduleFirstDemo;!function(t){"use strict";var o=function(){function t(t,o,e,s){var n=this;this.$scope=t,this.DataPostService=o,this.DataPostFactory=e,this.$location=s,this.title="Product list",this.showImage=!1,this.posts=[],this.showProgress=!0,"/"==s.path()&&setTimeout(function(){n.DataPostFactory.getPosts().then(function(t){n.posts=t.reverse(),n.showProgress=!1})},0)}return t.prototype.savePost=function(){var t=this;this.currentPost.publishDate=new Date,this.currentPost.author="John",this.currentPost.likes=0,this.currentPost.tags=["js","html","ionic"],tinyMCE&&(this.currentPost.postDescription=tinyMCE.activeEditor.getContent()),this.DataPostFactory.savePost(this.currentPost).then(function(o){t.$location.path("/posts")})},t.prototype.deletePost=function(t){var o=this;console.log("WTF "+t);var e=this.posts[t].id;console.log("ID",this.posts),this.DataPostFactory.deletePost(e).then(function(e){o.posts.splice(t,1)})},t.prototype.loadEditor=function(){var t=this;setTimeout(function(){t.$scope.$apply(function(){return t.showProgress=!1})},4e3)},t.$inject=["$scope","DataPostService","DataPostFactory","$location"],t}();t.PostListController=o,angular.module("demoModule").controller("PostListController",o)}(moduleFirstDemo||(moduleFirstDemo={}));var moduleFirstDemo;!function(t){"use strict";var o=function(){function t(t,o,e){this.DataPostFactory=t,this.$location=o,this.$routeParams=e,this.postId=e.id,this.getPost()}return t.prototype.getPost=function(){var t=this;this.DataPostFactory.getPost(this.postId).then(function(o){t.post=o,t.getComments()})},t.prototype.addNewLike=function(){this.post.likes=this.post.likes+1||0,this.DataPostFactory.savePost(this.post).then(function(t){})},t.prototype.getComments=function(){var t=this;this.DataPostFactory.getComments(this.postId).then(function(o){t.post.comments=o.reverse()})},t.prototype.saveComment=function(){var t=this;this.comment.createdOn=new Date,this.comment.postId=this.postId,this.DataPostFactory.saveComment(this.comment).then(function(o){t.post.comments.push(o),t.comment=null})},t.prototype.load=function(){alert()},t.$inject=["DataPostFactory","$location","$routeParams"],t}();t.PostViewController=o,angular.module("demoModule").controller("PostViewController",o)}(moduleFirstDemo||(moduleFirstDemo={}));var moduleFirstDemo;!function(t){"use strict";var o=function(){function t(){this.restrict="A"}return t.instance=function(){return new t},t.prototype.link=function(t,o,e){console.log(e),setTimeout(function(){o[0].focus()})},t}();t.Focus=o,angular.module("demoModule").directive("focus",o.instance)}(moduleFirstDemo||(moduleFirstDemo={}));var moduleFirstDemo;!function(t){"use strict";var o=function(){function t(){this.scope={showProgress:"="},this.restrict="E",this.templateUrl="app/directives/progressBar.html"}return t.instance=function(){return new t},t.prototype.link=function(t,o,e){t.value=0,console.log(t.showProgress),setInterval(function(){t.$apply(function(){return t.value>=100?void(t.value=0):void(t.value=t.value+10)})},1e3)},t}();t.Progressbar=o,angular.module("demoModule").directive("progressBar",o.instance)}(moduleFirstDemo||(moduleFirstDemo={}));var moduleFirstDemo;!function(t){var o;!function(t){var o=function(){function t(t,o,e,s,n){this.postId=t,this.commentId=o,this.body=e,this.createdOn=s,this.author=n}return t}();t.Comment=o}(o=t.domain||(t.domain={}))}(moduleFirstDemo||(moduleFirstDemo={}));var moduleFirstDemo;!function(t){var o;!function(t){var o=function(){function t(t,o,e,s,n,r,i,u,a,c){this.postId=t,this.postName=o,this.postDescription=e,this.postShortDescription=s,this.publishDate=n,this.likes=r,this.author=i,this.imageUrl=u,this.comments=a,this.tags=c}return t}();t.Post=o}(o=t.domain||(t.domain={}))}(moduleFirstDemo||(moduleFirstDemo={}));var moduleFirstDemo;!function(t){"use strict";function o(t){return new e(t)}var e=function(){function t(t){this.$http=t}return t.prototype.getPosts=function(){return this.$http.get("http://104.131.28.224:3000/posts/").then(function(t){return t.data})},t.prototype.savePost=function(t){return this.$http.post("http://104.131.28.224:3000/posts/",t).then(function(t){return t.data})},t.prototype.updatePost=function(t){return this.$http.put("http://104.131.28.224:3000/posts/"+t.postId,t).then(function(t){return t.data})},t.prototype.getPost=function(t){return this.$http.get("http://104.131.28.224:3000/posts/"+t).then(function(t){return t.data})},t.prototype.getComments=function(t){return this.$http.get("http://104.131.28.224:3000/comments/?postId="+t).then(function(t){return t.data})},t.prototype.saveComment=function(t){return this.$http.post("http://104.131.28.224:3000/comments/",t).then(function(t){return t.data})},t.prototype.deletePost=function(t){return this.$http["delete"]("http://104.131.28.224:3000/posts/"+t).then(function(t){return t.data})},t.$inject=["$http"],t}();t.DataPostFactory=e,o.$inject=["$http"],angular.module("demoModule").factory("DataPostFactory",o)}(moduleFirstDemo||(moduleFirstDemo={}));var moduleFirstDemo;!function(t){"use strict";function o(){return function(t,o){var e=[];return o?(angular.forEach(t,function(t){-1!=angular.lowercase(t.postName).indexOf(angular.lowercase(o))&&e.push(t)}),e):t}}t.StoreSearch=o,angular.module("demoModule").filter("storeSearch",o)}(moduleFirstDemo||(moduleFirstDemo={}));var moduleFirstDemo;!function(t){var o;!function(t){angular.module("common.services",["ngResource"])}(o=t.common||(t.common={}))}(moduleFirstDemo||(moduleFirstDemo={}));var moduleFirstDemo;!function(t){var o;!function(t){"use strict";var o=function(){function t(t){this.$resource=t}return t.prototype.getPostResource=function(){return this.$resource("http://104.131.28.224:3000/posts/:id")},t.$inject=["$resource"],t}();t.DataPostService=o,angular.module("common.services").service("DataPostService",o)}(o=t.common||(t.common={}))}(moduleFirstDemo||(moduleFirstDemo={}));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImNvbnRyb2xsZXJzL1Bvc3RMaXN0Q29udHJvbGxlci5qcyIsImNvbnRyb2xsZXJzL1Bvc3RWaWV3Q29udHJvbGxlci5qcyIsImRpcmVjdGl2ZXMvRm9jdXNJbnB1dC5qcyIsImRpcmVjdGl2ZXMvUHJvZ3Jlc3NCYXJEaXJlY3RpdmUuanMiLCJkb21haW5zL2NvbW1lbnQuanMiLCJkb21haW5zL3Bvc3QuanMiLCJmYWN0b3JpZXMvZGF0YVBvc3RGYWN0b3J5LmpzIiwiZmlsdGVycy90YWdGaWx0ZXIuanMiLCJzZXJ2aWNlcy9jb21tb24uc2VydmljZXMuanMiLCJzZXJ2aWNlcy9kYXRhUG9zdFNlcnZpY2VzLmpzIiwiYnVuZGxlLm1pbi5qcyJdLCJuYW1lcyI6WyJtb2R1bGVGaXJzdERlbW8iLCJkZW1vUm91dGVDb25maWciLCIkcm91dGVQcm92aWRlciIsIndoZW4iLCJ0ZW1wbGF0ZVVybCIsImNvbnRyb2xsZXIiLCJjb250cm9sbGVyQXMiLCJvdGhlcndpc2UiLCJkZW1vTW9kdWxlIiwiYW5ndWxhciIsIm1vZHVsZSIsImNvbmZpZyIsIiRpbmplY3QiLCJQb3N0TGlzdENvbnRyb2xsZXIiLCIkc2NvcGUiLCJEYXRhUG9zdFNlcnZpY2UiLCJEYXRhUG9zdEZhY3RvcnkiLCIkbG9jYXRpb24iLCJfdGhpcyIsInRoaXMiLCJ0aXRsZSIsInNob3dJbWFnZSIsInBvc3RzIiwic2hvd1Byb2dyZXNzIiwicGF0aCIsInNldFRpbWVvdXQiLCJnZXRQb3N0cyIsInRoZW4iLCJyZXMiLCJyZXZlcnNlIiwicHJvdG90eXBlIiwic2F2ZVBvc3QiLCJjdXJyZW50UG9zdCIsInB1Ymxpc2hEYXRlIiwiRGF0ZSIsImF1dGhvciIsImxpa2VzIiwidGFncyIsInRpbnlNQ0UiLCJwb3N0RGVzY3JpcHRpb24iLCJhY3RpdmVFZGl0b3IiLCJnZXRDb250ZW50IiwiZGVsZXRlUG9zdCIsImluZGV4IiwiY29uc29sZSIsImxvZyIsImlkIiwic3BsaWNlIiwibG9hZEVkaXRvciIsIiRhcHBseSIsIlBvc3RWaWV3Q29udHJvbGxlciIsIiRyb3V0ZVBhcmFtcyIsInBvc3RJZCIsImdldFBvc3QiLCJwb3N0IiwiZ2V0Q29tbWVudHMiLCJhZGROZXdMaWtlIiwiY29tbWVudHMiLCJzYXZlQ29tbWVudCIsImNvbW1lbnQiLCJjcmVhdGVkT24iLCJwdXNoIiwibG9hZCIsImFsZXJ0IiwiRm9jdXMiLCJyZXN0cmljdCIsImluc3RhbmNlIiwibGluayIsInNjb3BlIiwiZWxlbWVudHMiLCJhdHRycyIsImZvY3VzIiwiZGlyZWN0aXZlIiwiUHJvZ3Jlc3NiYXIiLCJ2YWx1ZSIsInNldEludGVydmFsIiwiZG9tYWluIiwiQ29tbWVudCIsImNvbW1lbnRJZCIsImJvZHkiLCJQb3N0IiwicG9zdE5hbWUiLCJwb3N0U2hvcnREZXNjcmlwdGlvbiIsImltYWdlVXJsIiwiZmFjdG9yeSIsIiRodHRwIiwiZ2V0IiwicmVzcG9uc2UiLCJkYXRhIiwidXBkYXRlUG9zdCIsInB1dCIsIlN0b3JlU2VhcmNoIiwiaXRlbXMiLCJzZWFyY2giLCJmaWx0ZXJlZCIsImZvckVhY2giLCJpdGVtIiwibG93ZXJjYXNlIiwiaW5kZXhPZiIsImZpbHRlciIsImNvbW1vbiIsIiRyZXNvdXJjZSIsImdldFBvc3RSZXNvdXJjZSIsInNlcnZpY2UiXSwibWFwcGluZ3MiOiJBQUFBLEdBQUFBLGtCQUNBLFNBQUFBLEdBQ0EsYUFHQSxTQUFBQyxHQUFBQyxHQUNBQSxFQUFBQyxLQUFBLEtBQ0FDLFlBQUEsMEJBQ0FDLFdBQUEscUJBQ0FDLGFBQUEsT0FDQUgsS0FBQSxjQUNBQyxZQUFBLHlCQUNBQyxXQUFBLHFCQUNBQyxhQUFBLE9BQ0FILEtBQUEsY0FDQUMsWUFBQSwwQkFDQUMsV0FBQSxxQkFDQUMsYUFBQSxPQUNBSCxLQUFBLG9CQUNBQyxZQUFBLDBCQUNBQyxXQUFBLHFCQUNBQyxhQUFBLE9BQ0FILEtBQUEsV0FDQUMsWUFBQSwwQkFDQUQsS0FBQSxnQkFDQUMsWUFBQSxrQ0FDQUcsVUFBQSxLQXZCQSxHQUFB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QUFBMkYsS0FDQSxNQUFBLFVBQUFDLEVBQUFDLEdBQ0EsR0FBQUMsS0FDQSxPQUFBRCxJQUdBcEYsUUFBQXNGLFFBQUFILEVBQUEsU0FBQUksR0FDQSxJQUFBdkYsUUFBQXdGLFVBQUFELEVBQUFmLFVBQUFpQixRQUFBekYsUUFBQXdGLFVBQUFKLEtBQ0FDLEVBQUFqQyxLQUFBbUMsS0FHQUYsR0FQQUYsR0FVQTVGLEVBQUEyRixZQUFBQSxFQUNBbEYsUUFBQUMsT0FBQSxjQUFBeUYsT0FBQSxjQUFBUixJQ3BCQTNGLGtCQUFBQSxvQkFFQSxJQUFBQSxrQkFDQSxTQUFBQSxHQUNBLEdBQUFvRyxJQUNBLFNBQUFBLEdBQ0EzRixRQUFBQyxPQUFBLG1CQUFBLGdCQUNBMEYsRUFBQXBHLEVBQUFvRyxTQUFBcEcsRUFBQW9HLGFDUEFwRyxrQkFBQUEsb0JBRUEsSUFBQUEsa0JBQ0EsU0FBQUEsR0FDQSxHQUFBb0csSUFDQSxTQUFBQSxHQUNBLFlBQ0EsSUFBQXJGLEdBQUEsV0FDQSxRQUFBQSxHQUFBc0YsR0FDQWxGLEtBQUFrRixVQUFBQSxFQU1BLE1BSkF0RixHQUFBZSxVQUFBd0UsZ0JBQUEsV0FDQSxNQUFBbkYsTUFBQWtGLFVBQUEseUNBRUF0RixFQUFBSCxTQUFBLGFBQ0FHLElBRUFxRixHQUFBckYsZ0JBQUFBLEVBQ0FOLFFBQ0FDLE9BQUEsbUJBQ0E2RixRQUFBLGtCQUFBeEYsSUFDQXFGLEVBQUFwRyxFQUFBb0csU0FBQXBHLEVBQUFvRyxhQ2tWR3BHLGtCQUFvQkEiLCJmaWxlIjoiYnVuZGxlLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBtb2R1bGVGaXJzdERlbW87XG4oZnVuY3Rpb24gKG1vZHVsZUZpcnN0RGVtbykge1xuICAgICd1c2VyIHN0cmljdCc7XG4gICAgdmFyIGRlbW9Nb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnZGVtb01vZHVsZScsIFsnbmdSb3V0ZScsICdjb21tb24uc2VydmljZXMnLCAnbmdTYW5pdGl6ZSddKTtcbiAgICBkZW1vTW9kdWxlLmNvbmZpZyhkZW1vUm91dGVDb25maWcpO1xuICAgIGZ1bmN0aW9uIGRlbW9Sb3V0ZUNvbmZpZygkcm91dGVQcm92aWRlcikge1xuICAgICAgICAkcm91dGVQcm92aWRlci53aGVuKCcvJywge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvdmlld3MvcG9zdExpc3QuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnUG9zdExpc3RDb250cm9sbGVyJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJ1xuICAgICAgICB9KS53aGVuKCcvcG9zdHMvbmV3Jywge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvdmlld3MvbmV3UG9zdC5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdQb3N0TGlzdENvbnRyb2xsZXInLFxuICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nXG4gICAgICAgIH0pLndoZW4oJy9wb3N0cy86aWQnLCB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcC92aWV3cy92aWV3UG9zdC5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdQb3N0Vmlld0NvbnRyb2xsZXInLFxuICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nXG4gICAgICAgIH0pLndoZW4oJy9hZG1pbi9wb3N0cy86aWQnLCB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcC92aWV3cy92aWV3UG9zdC5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdQb3N0Vmlld0NvbnRyb2xsZXInLFxuICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nXG4gICAgICAgIH0pLndoZW4oJy9hY2VyY2EnLCB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcC92aWV3cy9hY2VyY2EuaHRtbCdcbiAgICAgICAgfSkud2hlbignL2FkbWluL3Bvc3RzJywge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvdmlld3MvYWRtaW4vcG9zdExpc3QuaHRtbCdcbiAgICAgICAgfSkub3RoZXJ3aXNlKCcvJyk7XG4gICAgfVxufSkobW9kdWxlRmlyc3REZW1vIHx8IChtb2R1bGVGaXJzdERlbW8gPSB7fSkpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLmpzLm1hcCIsInZhciBtb2R1bGVGaXJzdERlbW87XG4oZnVuY3Rpb24gKG1vZHVsZUZpcnN0RGVtbykge1xuICAgICd1c2Ugc3RyaWN0JztcbiAgICB2YXIgUG9zdExpc3RDb250cm9sbGVyID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gUG9zdExpc3RDb250cm9sbGVyKCRzY29wZSwgRGF0YVBvc3RTZXJ2aWNlLCBEYXRhUG9zdEZhY3RvcnksICRsb2NhdGlvbikge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIHRoaXMuJHNjb3BlID0gJHNjb3BlO1xuICAgICAgICAgICAgdGhpcy5EYXRhUG9zdFNlcnZpY2UgPSBEYXRhUG9zdFNlcnZpY2U7XG4gICAgICAgICAgICB0aGlzLkRhdGFQb3N0RmFjdG9yeSA9IERhdGFQb3N0RmFjdG9yeTtcbiAgICAgICAgICAgIHRoaXMuJGxvY2F0aW9uID0gJGxvY2F0aW9uO1xuICAgICAgICAgICAgdGhpcy50aXRsZSA9IFwiUHJvZHVjdCBsaXN0XCI7XG4gICAgICAgICAgICB0aGlzLnNob3dJbWFnZSA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5wb3N0cyA9IFtdO1xuICAgICAgICAgICAgdGhpcy5zaG93UHJvZ3Jlc3MgPSB0cnVlO1xuICAgICAgICAgICAgaWYgKCRsb2NhdGlvbi5wYXRoKCkgPT0gXCIvXCIpIHtcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuRGF0YVBvc3RGYWN0b3J5LmdldFBvc3RzKCkudGhlbihmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5wb3N0cyA9IHJlcy5yZXZlcnNlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5zaG93UHJvZ3Jlc3MgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSwgMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgUG9zdExpc3RDb250cm9sbGVyLnByb3RvdHlwZS5zYXZlUG9zdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRQb3N0LnB1Ymxpc2hEYXRlID0gbmV3IERhdGUoKTtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFBvc3QuYXV0aG9yID0gXCJKb2huXCI7IC8vIFRPRE86IHNob3VsZCBsb2FkIGZyb20gc2Vzc2lvbiA6dlxuICAgICAgICAgICAgdGhpcy5jdXJyZW50UG9zdC5saWtlcyA9IDA7XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRQb3N0LnRhZ3MgPSBbXCJqc1wiLCBcImh0bWxcIiwgXCJpb25pY1wiXTtcbiAgICAgICAgICAgIGlmICh0aW55TUNFKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50UG9zdC5wb3N0RGVzY3JpcHRpb24gPSB0aW55TUNFLmFjdGl2ZUVkaXRvci5nZXRDb250ZW50KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLkRhdGFQb3N0RmFjdG9yeS5zYXZlUG9zdCh0aGlzLmN1cnJlbnRQb3N0KS50aGVuKGZ1bmN0aW9uIChyZXMpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy4kbG9jYXRpb24ucGF0aCgnL3Bvc3RzJyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgUG9zdExpc3RDb250cm9sbGVyLnByb3RvdHlwZS5kZWxldGVQb3N0ID0gZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ1dURiAnICsgaW5kZXgpO1xuICAgICAgICAgICAgdmFyIGlkID0gdGhpcy5wb3N0c1tpbmRleF1bJ2lkJ107XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnSUQnLCB0aGlzLnBvc3RzKTtcbiAgICAgICAgICAgIHRoaXMuRGF0YVBvc3RGYWN0b3J5LmRlbGV0ZVBvc3QoaWQpLnRoZW4oZnVuY3Rpb24gKHJlcykge1xuICAgICAgICAgICAgICAgIF90aGlzLnBvc3RzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgUG9zdExpc3RDb250cm9sbGVyLnByb3RvdHlwZS5sb2FkRWRpdG9yID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIF90aGlzLiRzY29wZS4kYXBwbHkoZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMuc2hvd1Byb2dyZXNzID0gZmFsc2U7IH0pO1xuICAgICAgICAgICAgfSwgNDAwMCk7XG4gICAgICAgIH07XG4gICAgICAgIFBvc3RMaXN0Q29udHJvbGxlci4kaW5qZWN0ID0gW1wiJHNjb3BlXCIsICdEYXRhUG9zdFNlcnZpY2UnLCAnRGF0YVBvc3RGYWN0b3J5JywgJyRsb2NhdGlvbiddO1xuICAgICAgICByZXR1cm4gUG9zdExpc3RDb250cm9sbGVyO1xuICAgIH0oKSk7XG4gICAgbW9kdWxlRmlyc3REZW1vLlBvc3RMaXN0Q29udHJvbGxlciA9IFBvc3RMaXN0Q29udHJvbGxlcjtcbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2RlbW9Nb2R1bGUnKVxuICAgICAgICAuY29udHJvbGxlcignUG9zdExpc3RDb250cm9sbGVyJywgUG9zdExpc3RDb250cm9sbGVyKTtcbn0pKG1vZHVsZUZpcnN0RGVtbyB8fCAobW9kdWxlRmlyc3REZW1vID0ge30pKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVBvc3RMaXN0Q29udHJvbGxlci5qcy5tYXAiLCJ2YXIgbW9kdWxlRmlyc3REZW1vO1xuKGZ1bmN0aW9uIChtb2R1bGVGaXJzdERlbW8pIHtcbiAgICAndXNlIHN0cmljdCc7XG4gICAgdmFyIFBvc3RWaWV3Q29udHJvbGxlciA9IChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZ1bmN0aW9uIFBvc3RWaWV3Q29udHJvbGxlcihEYXRhUG9zdEZhY3RvcnksICRsb2NhdGlvbiwgJHJvdXRlUGFyYW1zKSB7XG4gICAgICAgICAgICB0aGlzLkRhdGFQb3N0RmFjdG9yeSA9IERhdGFQb3N0RmFjdG9yeTtcbiAgICAgICAgICAgIHRoaXMuJGxvY2F0aW9uID0gJGxvY2F0aW9uO1xuICAgICAgICAgICAgdGhpcy4kcm91dGVQYXJhbXMgPSAkcm91dGVQYXJhbXM7XG4gICAgICAgICAgICB0aGlzLnBvc3RJZCA9ICRyb3V0ZVBhcmFtcy5pZDtcbiAgICAgICAgICAgIHRoaXMuZ2V0UG9zdCgpO1xuICAgICAgICB9XG4gICAgICAgIFBvc3RWaWV3Q29udHJvbGxlci5wcm90b3R5cGUuZ2V0UG9zdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICB0aGlzLkRhdGFQb3N0RmFjdG9yeS5nZXRQb3N0KHRoaXMucG9zdElkKS50aGVuKGZ1bmN0aW9uIChyZXMpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5wb3N0ID0gcmVzO1xuICAgICAgICAgICAgICAgIF90aGlzLmdldENvbW1lbnRzKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgUG9zdFZpZXdDb250cm9sbGVyLnByb3RvdHlwZS5hZGROZXdMaWtlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5wb3N0Lmxpa2VzID0gKHRoaXMucG9zdC5saWtlcyArIDEpIHx8IDA7XG4gICAgICAgICAgICB0aGlzLkRhdGFQb3N0RmFjdG9yeS5zYXZlUG9zdCh0aGlzLnBvc3QpLnRoZW4oZnVuY3Rpb24gKHJlcykge1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIFBvc3RWaWV3Q29udHJvbGxlci5wcm90b3R5cGUuZ2V0Q29tbWVudHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgdGhpcy5EYXRhUG9zdEZhY3RvcnkuZ2V0Q29tbWVudHModGhpcy5wb3N0SWQpLnRoZW4oZnVuY3Rpb24gKHJlcykge1xuICAgICAgICAgICAgICAgIF90aGlzLnBvc3QuY29tbWVudHMgPSByZXMucmV2ZXJzZSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIFBvc3RWaWV3Q29udHJvbGxlci5wcm90b3R5cGUuc2F2ZUNvbW1lbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgdGhpcy5jb21tZW50LmNyZWF0ZWRPbiA9IG5ldyBEYXRlKCk7XG4gICAgICAgICAgICB0aGlzLmNvbW1lbnQucG9zdElkID0gdGhpcy5wb3N0SWQ7XG4gICAgICAgICAgICB0aGlzLkRhdGFQb3N0RmFjdG9yeS5zYXZlQ29tbWVudCh0aGlzLmNvbW1lbnQpLnRoZW4oZnVuY3Rpb24gKHJlcykge1xuICAgICAgICAgICAgICAgIF90aGlzLnBvc3QuY29tbWVudHMucHVzaChyZXMpO1xuICAgICAgICAgICAgICAgIF90aGlzLmNvbW1lbnQgPSBudWxsO1xuICAgICAgICAgICAgICAgIC8vdGhpcy4kbG9jYXRpb24ucGF0aCgnL3Bvc3RzJyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgUG9zdFZpZXdDb250cm9sbGVyLnByb3RvdHlwZS5sb2FkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgYWxlcnQoKTtcbiAgICAgICAgfTtcbiAgICAgICAgUG9zdFZpZXdDb250cm9sbGVyLiRpbmplY3QgPSBbJ0RhdGFQb3N0RmFjdG9yeScsICckbG9jYXRpb24nLCAnJHJvdXRlUGFyYW1zJ107XG4gICAgICAgIHJldHVybiBQb3N0Vmlld0NvbnRyb2xsZXI7XG4gICAgfSgpKTtcbiAgICBtb2R1bGVGaXJzdERlbW8uUG9zdFZpZXdDb250cm9sbGVyID0gUG9zdFZpZXdDb250cm9sbGVyO1xuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnZGVtb01vZHVsZScpXG4gICAgICAgIC5jb250cm9sbGVyKCdQb3N0Vmlld0NvbnRyb2xsZXInLCBQb3N0Vmlld0NvbnRyb2xsZXIpO1xufSkobW9kdWxlRmlyc3REZW1vIHx8IChtb2R1bGVGaXJzdERlbW8gPSB7fSkpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9UG9zdFZpZXdDb250cm9sbGVyLmpzLm1hcCIsInZhciBtb2R1bGVGaXJzdERlbW87XG4oZnVuY3Rpb24gKG1vZHVsZUZpcnN0RGVtbykge1xuICAgICd1c2Ugc3RyaWN0JztcbiAgICB2YXIgRm9jdXMgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBGb2N1cygpIHtcbiAgICAgICAgICAgIHRoaXMucmVzdHJpY3QgPSAnQSc7XG4gICAgICAgIH1cbiAgICAgICAgRm9jdXMuaW5zdGFuY2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IEZvY3VzO1xuICAgICAgICB9O1xuICAgICAgICBGb2N1cy5wcm90b3R5cGUubGluayA9IGZ1bmN0aW9uIChzY29wZSwgZWxlbWVudHMsIGF0dHJzKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhhdHRycyk7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBlbGVtZW50c1swXS5mb2N1cygpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBGb2N1cztcbiAgICB9KCkpO1xuICAgIG1vZHVsZUZpcnN0RGVtby5Gb2N1cyA9IEZvY3VzO1xuICAgIGFuZ3VsYXIubW9kdWxlKCdkZW1vTW9kdWxlJylcbiAgICAgICAgLmRpcmVjdGl2ZSgnZm9jdXMnLCBGb2N1cy5pbnN0YW5jZSk7XG59KShtb2R1bGVGaXJzdERlbW8gfHwgKG1vZHVsZUZpcnN0RGVtbyA9IHt9KSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1Gb2N1c0lucHV0LmpzLm1hcCIsInZhciBtb2R1bGVGaXJzdERlbW87XG4oZnVuY3Rpb24gKG1vZHVsZUZpcnN0RGVtbykge1xuICAgICd1c2Ugc3RyaWN0JztcbiAgICB2YXIgUHJvZ3Jlc3NiYXIgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBQcm9ncmVzc2JhcigpIHtcbiAgICAgICAgICAgIHRoaXMuc2NvcGUgPSB7XG4gICAgICAgICAgICAgICAgJ3Nob3dQcm9ncmVzcyc6ICc9J1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRoaXMucmVzdHJpY3QgPSAnRSc7XG4gICAgICAgICAgICAvL3RlbXBsYXRlPSc8ZGl2IGNsYXNzPVwicHJvZ3Jlc3NcIj48ZGl2IGNsYXNzPVwicHJvZ3Jlc3MtYmFyXCIgcm9sZT1cInByb2dyZXNzYmFyXCIgYXJpYS12YWx1ZW5vdz1cInt7IHZhbHVlIH19XCIgYXJpYS12YWx1ZW1pbj1cIjBcIiBhcmlhLXZhbHVlbWF4PVwiMTAwXCIgc3R5bGU9XCJ3aWR0aDoge3sgdmFsdWUgfX0lO1wiPjxzcGFuIGNsYXNzPVwic3Itb25seVwiPjYwJSBDb21wbGV0ZTwvc3Bhbj48L2Rpdj48L2Rpdj48ZGl2PjxzcGFuPnt7IHZhbHVlIH19JSBDb21wbGV0ZWQ8L3NwYW4+PC9kaXY+JztcbiAgICAgICAgICAgIHRoaXMudGVtcGxhdGVVcmwgPSAnYXBwL2RpcmVjdGl2ZXMvcHJvZ3Jlc3NCYXIuaHRtbCc7XG4gICAgICAgIH1cbiAgICAgICAgUHJvZ3Jlc3NiYXIuaW5zdGFuY2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb2dyZXNzYmFyO1xuICAgICAgICB9O1xuICAgICAgICBQcm9ncmVzc2Jhci5wcm90b3R5cGUubGluayA9IGZ1bmN0aW9uIChzY29wZSwgZWxlbWVudHMsIGF0dHJzKSB7XG4gICAgICAgICAgICBzY29wZS52YWx1ZSA9IDA7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhzY29wZS5zaG93UHJvZ3Jlc3MpO1xuICAgICAgICAgICAgc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHNjb3BlLiRhcHBseShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzY29wZS52YWx1ZSA+PSAxMDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLnZhbHVlID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBzY29wZS52YWx1ZSA9IHNjb3BlLnZhbHVlICsgMTA7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LCAxMDAwKTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIFByb2dyZXNzYmFyO1xuICAgIH0oKSk7XG4gICAgbW9kdWxlRmlyc3REZW1vLlByb2dyZXNzYmFyID0gUHJvZ3Jlc3NiYXI7XG4gICAgYW5ndWxhci5tb2R1bGUoJ2RlbW9Nb2R1bGUnKVxuICAgICAgICAuZGlyZWN0aXZlKCdwcm9ncmVzc0JhcicsIFByb2dyZXNzYmFyLmluc3RhbmNlKTtcbn0pKG1vZHVsZUZpcnN0RGVtbyB8fCAobW9kdWxlRmlyc3REZW1vID0ge30pKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVByb2dyZXNzQmFyRGlyZWN0aXZlLmpzLm1hcCIsInZhciBtb2R1bGVGaXJzdERlbW87XG4oZnVuY3Rpb24gKG1vZHVsZUZpcnN0RGVtbykge1xuICAgIHZhciBkb21haW47XG4gICAgKGZ1bmN0aW9uIChkb21haW4pIHtcbiAgICAgICAgdmFyIENvbW1lbnQgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZnVuY3Rpb24gQ29tbWVudChwb3N0SWQsIGNvbW1lbnRJZCwgYm9keSwgY3JlYXRlZE9uLCBhdXRob3IpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBvc3RJZCA9IHBvc3RJZDtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbW1lbnRJZCA9IGNvbW1lbnRJZDtcbiAgICAgICAgICAgICAgICB0aGlzLmJvZHkgPSBib2R5O1xuICAgICAgICAgICAgICAgIHRoaXMuY3JlYXRlZE9uID0gY3JlYXRlZE9uO1xuICAgICAgICAgICAgICAgIHRoaXMuYXV0aG9yID0gYXV0aG9yO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIENvbW1lbnQ7XG4gICAgICAgIH0oKSk7XG4gICAgICAgIGRvbWFpbi5Db21tZW50ID0gQ29tbWVudDtcbiAgICB9KShkb21haW4gPSBtb2R1bGVGaXJzdERlbW8uZG9tYWluIHx8IChtb2R1bGVGaXJzdERlbW8uZG9tYWluID0ge30pKTtcbn0pKG1vZHVsZUZpcnN0RGVtbyB8fCAobW9kdWxlRmlyc3REZW1vID0ge30pKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWNvbW1lbnQuanMubWFwIiwidmFyIG1vZHVsZUZpcnN0RGVtbztcbihmdW5jdGlvbiAobW9kdWxlRmlyc3REZW1vKSB7XG4gICAgdmFyIGRvbWFpbjtcbiAgICAoZnVuY3Rpb24gKGRvbWFpbikge1xuICAgICAgICB2YXIgUG9zdCA9IChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBmdW5jdGlvbiBQb3N0KHBvc3RJZCwgcG9zdE5hbWUsIHBvc3REZXNjcmlwdGlvbiwgcG9zdFNob3J0RGVzY3JpcHRpb24sIHB1Ymxpc2hEYXRlLCBsaWtlcywgYXV0aG9yLCBpbWFnZVVybCwgY29tbWVudHMsIHRhZ3MpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBvc3RJZCA9IHBvc3RJZDtcbiAgICAgICAgICAgICAgICB0aGlzLnBvc3ROYW1lID0gcG9zdE5hbWU7XG4gICAgICAgICAgICAgICAgdGhpcy5wb3N0RGVzY3JpcHRpb24gPSBwb3N0RGVzY3JpcHRpb247XG4gICAgICAgICAgICAgICAgdGhpcy5wb3N0U2hvcnREZXNjcmlwdGlvbiA9IHBvc3RTaG9ydERlc2NyaXB0aW9uO1xuICAgICAgICAgICAgICAgIHRoaXMucHVibGlzaERhdGUgPSBwdWJsaXNoRGF0ZTtcbiAgICAgICAgICAgICAgICB0aGlzLmxpa2VzID0gbGlrZXM7XG4gICAgICAgICAgICAgICAgdGhpcy5hdXRob3IgPSBhdXRob3I7XG4gICAgICAgICAgICAgICAgdGhpcy5pbWFnZVVybCA9IGltYWdlVXJsO1xuICAgICAgICAgICAgICAgIHRoaXMuY29tbWVudHMgPSBjb21tZW50cztcbiAgICAgICAgICAgICAgICB0aGlzLnRhZ3MgPSB0YWdzO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIFBvc3Q7XG4gICAgICAgIH0oKSk7XG4gICAgICAgIGRvbWFpbi5Qb3N0ID0gUG9zdDtcbiAgICB9KShkb21haW4gPSBtb2R1bGVGaXJzdERlbW8uZG9tYWluIHx8IChtb2R1bGVGaXJzdERlbW8uZG9tYWluID0ge30pKTtcbn0pKG1vZHVsZUZpcnN0RGVtbyB8fCAobW9kdWxlRmlyc3REZW1vID0ge30pKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBvc3QuanMubWFwIiwidmFyIG1vZHVsZUZpcnN0RGVtbztcbihmdW5jdGlvbiAobW9kdWxlRmlyc3REZW1vKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuICAgIHZhciBEYXRhUG9zdEZhY3RvcnkgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBEYXRhUG9zdEZhY3RvcnkoJGh0dHApIHtcbiAgICAgICAgICAgIHRoaXMuJGh0dHAgPSAkaHR0cDtcbiAgICAgICAgfVxuICAgICAgICBEYXRhUG9zdEZhY3RvcnkucHJvdG90eXBlLmdldFBvc3RzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuJGh0dHBcbiAgICAgICAgICAgICAgICAuZ2V0KCdodHRwOi8vMTA0LjEzMS4yOC4yMjQ6MzAwMC9wb3N0cy8nKVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5kYXRhO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIERhdGFQb3N0RmFjdG9yeS5wcm90b3R5cGUuc2F2ZVBvc3QgPSBmdW5jdGlvbiAocG9zdCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuJGh0dHBcbiAgICAgICAgICAgICAgICAucG9zdCgnaHR0cDovLzEwNC4xMzEuMjguMjI0OjMwMDAvcG9zdHMvJywgcG9zdClcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICBEYXRhUG9zdEZhY3RvcnkucHJvdG90eXBlLnVwZGF0ZVBvc3QgPSBmdW5jdGlvbiAocG9zdCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuJGh0dHBcbiAgICAgICAgICAgICAgICAucHV0KCdodHRwOi8vMTA0LjEzMS4yOC4yMjQ6MzAwMC9wb3N0cy8nICsgcG9zdC5wb3N0SWQsIHBvc3QpXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGE7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgRGF0YVBvc3RGYWN0b3J5LnByb3RvdHlwZS5nZXRQb3N0ID0gZnVuY3Rpb24gKGlkKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy4kaHR0cFxuICAgICAgICAgICAgICAgIC5nZXQoJ2h0dHA6Ly8xMDQuMTMxLjI4LjIyNDozMDAwL3Bvc3RzLycgKyBpZClcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICBEYXRhUG9zdEZhY3RvcnkucHJvdG90eXBlLmdldENvbW1lbnRzID0gZnVuY3Rpb24gKHBvc3RJZCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuJGh0dHBcbiAgICAgICAgICAgICAgICAuZ2V0KCdodHRwOi8vMTA0LjEzMS4yOC4yMjQ6MzAwMC9jb21tZW50cy8/cG9zdElkPScgKyBwb3N0SWQpXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGE7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgRGF0YVBvc3RGYWN0b3J5LnByb3RvdHlwZS5zYXZlQ29tbWVudCA9IGZ1bmN0aW9uIChjb21tZW50KSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy4kaHR0cFxuICAgICAgICAgICAgICAgIC5wb3N0KCdodHRwOi8vMTA0LjEzMS4yOC4yMjQ6MzAwMC9jb21tZW50cy8nLCBjb21tZW50KVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5kYXRhO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIERhdGFQb3N0RmFjdG9yeS5wcm90b3R5cGUuZGVsZXRlUG9zdCA9IGZ1bmN0aW9uIChpZCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuJGh0dHBcbiAgICAgICAgICAgICAgICAuZGVsZXRlKCdodHRwOi8vMTA0LjEzMS4yOC4yMjQ6MzAwMC9wb3N0cy8nICsgaWQpXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGE7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgRGF0YVBvc3RGYWN0b3J5LiRpbmplY3QgPSBbJyRodHRwJ107XG4gICAgICAgIHJldHVybiBEYXRhUG9zdEZhY3Rvcnk7XG4gICAgfSgpKTtcbiAgICBtb2R1bGVGaXJzdERlbW8uRGF0YVBvc3RGYWN0b3J5ID0gRGF0YVBvc3RGYWN0b3J5O1xuICAgIGZ1bmN0aW9uIGZhY3RvcnkoJGh0dHApIHtcbiAgICAgICAgcmV0dXJuIG5ldyBEYXRhUG9zdEZhY3RvcnkoJGh0dHApO1xuICAgIH1cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2RlbW9Nb2R1bGUnKVxuICAgICAgICAuZmFjdG9yeSgnRGF0YVBvc3RGYWN0b3J5JywgZmFjdG9yeSk7XG59KShtb2R1bGVGaXJzdERlbW8gfHwgKG1vZHVsZUZpcnN0RGVtbyA9IHt9KSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1kYXRhUG9zdEZhY3RvcnkuanMubWFwIiwidmFyIG1vZHVsZUZpcnN0RGVtbztcbihmdW5jdGlvbiAobW9kdWxlRmlyc3REZW1vKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuICAgIGZ1bmN0aW9uIFN0b3JlU2VhcmNoKCkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGl0ZW1zLCBzZWFyY2gpIHtcbiAgICAgICAgICAgIHZhciBmaWx0ZXJlZCA9IFtdO1xuICAgICAgICAgICAgaWYgKCFzZWFyY2gpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaXRlbXM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhbmd1bGFyLmZvckVhY2goaXRlbXMsIGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgaWYgKGFuZ3VsYXIubG93ZXJjYXNlKGl0ZW0ucG9zdE5hbWUpLmluZGV4T2YoYW5ndWxhci5sb3dlcmNhc2Uoc2VhcmNoKSkgIT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgZmlsdGVyZWQucHVzaChpdGVtKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBmaWx0ZXJlZDtcbiAgICAgICAgfTtcbiAgICB9XG4gICAgbW9kdWxlRmlyc3REZW1vLlN0b3JlU2VhcmNoID0gU3RvcmVTZWFyY2g7XG4gICAgYW5ndWxhci5tb2R1bGUoXCJkZW1vTW9kdWxlXCIpLmZpbHRlcihcInN0b3JlU2VhcmNoXCIsIFN0b3JlU2VhcmNoKTtcbn0pKG1vZHVsZUZpcnN0RGVtbyB8fCAobW9kdWxlRmlyc3REZW1vID0ge30pKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXRhZ0ZpbHRlci5qcy5tYXAiLCJ2YXIgbW9kdWxlRmlyc3REZW1vO1xuKGZ1bmN0aW9uIChtb2R1bGVGaXJzdERlbW8pIHtcbiAgICB2YXIgY29tbW9uO1xuICAgIChmdW5jdGlvbiAoY29tbW9uKSB7XG4gICAgICAgIGFuZ3VsYXIubW9kdWxlKCdjb21tb24uc2VydmljZXMnLCBbJ25nUmVzb3VyY2UnXSk7XG4gICAgfSkoY29tbW9uID0gbW9kdWxlRmlyc3REZW1vLmNvbW1vbiB8fCAobW9kdWxlRmlyc3REZW1vLmNvbW1vbiA9IHt9KSk7XG59KShtb2R1bGVGaXJzdERlbW8gfHwgKG1vZHVsZUZpcnN0RGVtbyA9IHt9KSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1jb21tb24uc2VydmljZXMuanMubWFwIiwidmFyIG1vZHVsZUZpcnN0RGVtbztcbihmdW5jdGlvbiAobW9kdWxlRmlyc3REZW1vKSB7XG4gICAgdmFyIGNvbW1vbjtcbiAgICAoZnVuY3Rpb24gKGNvbW1vbikge1xuICAgICAgICAndXNlIHN0cmljdCc7XG4gICAgICAgIHZhciBEYXRhUG9zdFNlcnZpY2UgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZnVuY3Rpb24gRGF0YVBvc3RTZXJ2aWNlKCRyZXNvdXJjZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuJHJlc291cmNlID0gJHJlc291cmNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgRGF0YVBvc3RTZXJ2aWNlLnByb3RvdHlwZS5nZXRQb3N0UmVzb3VyY2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuJHJlc291cmNlKFwiaHR0cDovLzEwNC4xMzEuMjguMjI0OjMwMDAvcG9zdHMvOmlkXCIpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIERhdGFQb3N0U2VydmljZS4kaW5qZWN0ID0gWyckcmVzb3VyY2UnXTtcbiAgICAgICAgICAgIHJldHVybiBEYXRhUG9zdFNlcnZpY2U7XG4gICAgICAgIH0oKSk7XG4gICAgICAgIGNvbW1vbi5EYXRhUG9zdFNlcnZpY2UgPSBEYXRhUG9zdFNlcnZpY2U7XG4gICAgICAgIGFuZ3VsYXJcbiAgICAgICAgICAgIC5tb2R1bGUoJ2NvbW1vbi5zZXJ2aWNlcycpXG4gICAgICAgICAgICAuc2VydmljZSgnRGF0YVBvc3RTZXJ2aWNlJywgRGF0YVBvc3RTZXJ2aWNlKTtcbiAgICB9KShjb21tb24gPSBtb2R1bGVGaXJzdERlbW8uY29tbW9uIHx8IChtb2R1bGVGaXJzdERlbW8uY29tbW9uID0ge30pKTtcbn0pKG1vZHVsZUZpcnN0RGVtbyB8fCAobW9kdWxlRmlyc3REZW1vID0ge30pKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWRhdGFQb3N0U2VydmljZXMuanMubWFwIiwidmFyIG1vZHVsZUZpcnN0RGVtbztcbihmdW5jdGlvbiAobW9kdWxlRmlyc3REZW1vKSB7XG4gICAgJ3VzZXIgc3RyaWN0JztcbiAgICB2YXIgZGVtb01vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdkZW1vTW9kdWxlJywgWyduZ1JvdXRlJywgJ2NvbW1vbi5zZXJ2aWNlcycsICduZ1Nhbml0aXplJ10pO1xuICAgIGRlbW9Nb2R1bGUuY29uZmlnKGRlbW9Sb3V0ZUNvbmZpZyk7XG4gICAgZnVuY3Rpb24gZGVtb1JvdXRlQ29uZmlnKCRyb3V0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRyb3V0ZVByb3ZpZGVyLndoZW4oJy8nLCB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcC92aWV3cy9wb3N0TGlzdC5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdQb3N0TGlzdENvbnRyb2xsZXInLFxuICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nXG4gICAgICAgIH0pLndoZW4oJy9wb3N0cy9uZXcnLCB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcC92aWV3cy9uZXdQb3N0Lmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ1Bvc3RMaXN0Q29udHJvbGxlcicsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bSdcbiAgICAgICAgfSkud2hlbignL3Bvc3RzLzppZCcsIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwL3ZpZXdzL3ZpZXdQb3N0Lmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ1Bvc3RWaWV3Q29udHJvbGxlcicsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bSdcbiAgICAgICAgfSkud2hlbignL2FkbWluL3Bvc3RzLzppZCcsIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwL3ZpZXdzL3ZpZXdQb3N0Lmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ1Bvc3RWaWV3Q29udHJvbGxlcicsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bSdcbiAgICAgICAgfSkud2hlbignL2FjZXJjYScsIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwL3ZpZXdzL2FjZXJjYS5odG1sJ1xuICAgICAgICB9KS53aGVuKCcvYWRtaW4vcG9zdHMnLCB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcC92aWV3cy9hZG1pbi9wb3N0TGlzdC5odG1sJ1xuICAgICAgICB9KS5vdGhlcndpc2UoJy8nKTtcbiAgICB9XG4gICAgZGVtb1JvdXRlQ29uZmlnLiRpbmplY3QgPSBbXCIkcm91dGVQcm92aWRlclwiXTtcbn0pKG1vZHVsZUZpcnN0RGVtbyB8fCAobW9kdWxlRmlyc3REZW1vID0ge30pKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC5qcy5tYXBcbnZhciBtb2R1bGVGaXJzdERlbW87XG4oZnVuY3Rpb24gKG1vZHVsZUZpcnN0RGVtbykge1xuICAgICd1c2Ugc3RyaWN0JztcbiAgICB2YXIgUG9zdExpc3RDb250cm9sbGVyID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gUG9zdExpc3RDb250cm9sbGVyKCRzY29wZSwgRGF0YVBvc3RTZXJ2aWNlLCBEYXRhUG9zdEZhY3RvcnksICRsb2NhdGlvbikge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIHRoaXMuJHNjb3BlID0gJHNjb3BlO1xuICAgICAgICAgICAgdGhpcy5EYXRhUG9zdFNlcnZpY2UgPSBEYXRhUG9zdFNlcnZpY2U7XG4gICAgICAgICAgICB0aGlzLkRhdGFQb3N0RmFjdG9yeSA9IERhdGFQb3N0RmFjdG9yeTtcbiAgICAgICAgICAgIHRoaXMuJGxvY2F0aW9uID0gJGxvY2F0aW9uO1xuICAgICAgICAgICAgdGhpcy50aXRsZSA9IFwiUHJvZHVjdCBsaXN0XCI7XG4gICAgICAgICAgICB0aGlzLnNob3dJbWFnZSA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5wb3N0cyA9IFtdO1xuICAgICAgICAgICAgdGhpcy5zaG93UHJvZ3Jlc3MgPSB0cnVlO1xuICAgICAgICAgICAgaWYgKCRsb2NhdGlvbi5wYXRoKCkgPT0gXCIvXCIpIHtcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuRGF0YVBvc3RGYWN0b3J5LmdldFBvc3RzKCkudGhlbihmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5wb3N0cyA9IHJlcy5yZXZlcnNlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5zaG93UHJvZ3Jlc3MgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSwgMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgUG9zdExpc3RDb250cm9sbGVyLnByb3RvdHlwZS5zYXZlUG9zdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRQb3N0LnB1Ymxpc2hEYXRlID0gbmV3IERhdGUoKTtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFBvc3QuYXV0aG9yID0gXCJKb2huXCI7IC8vIFRPRE86IHNob3VsZCBsb2FkIGZyb20gc2Vzc2lvbiA6dlxuICAgICAgICAgICAgdGhpcy5jdXJyZW50UG9zdC5saWtlcyA9IDA7XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRQb3N0LnRhZ3MgPSBbXCJqc1wiLCBcImh0bWxcIiwgXCJpb25pY1wiXTtcbiAgICAgICAgICAgIGlmICh0aW55TUNFKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50UG9zdC5wb3N0RGVzY3JpcHRpb24gPSB0aW55TUNFLmFjdGl2ZUVkaXRvci5nZXRDb250ZW50KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLkRhdGFQb3N0RmFjdG9yeS5zYXZlUG9zdCh0aGlzLmN1cnJlbnRQb3N0KS50aGVuKGZ1bmN0aW9uIChyZXMpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy4kbG9jYXRpb24ucGF0aCgnL3Bvc3RzJyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgUG9zdExpc3RDb250cm9sbGVyLnByb3RvdHlwZS5kZWxldGVQb3N0ID0gZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ1dURiAnICsgaW5kZXgpO1xuICAgICAgICAgICAgdmFyIGlkID0gdGhpcy5wb3N0c1tpbmRleF1bJ2lkJ107XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnSUQnLCB0aGlzLnBvc3RzKTtcbiAgICAgICAgICAgIHRoaXMuRGF0YVBvc3RGYWN0b3J5LmRlbGV0ZVBvc3QoaWQpLnRoZW4oZnVuY3Rpb24gKHJlcykge1xuICAgICAgICAgICAgICAgIF90aGlzLnBvc3RzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgUG9zdExpc3RDb250cm9sbGVyLnByb3RvdHlwZS5sb2FkRWRpdG9yID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIF90aGlzLiRzY29wZS4kYXBwbHkoZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMuc2hvd1Byb2dyZXNzID0gZmFsc2U7IH0pO1xuICAgICAgICAgICAgfSwgNDAwMCk7XG4gICAgICAgIH07XG4gICAgICAgIFBvc3RMaXN0Q29udHJvbGxlci4kaW5qZWN0ID0gW1wiJHNjb3BlXCIsICdEYXRhUG9zdFNlcnZpY2UnLCAnRGF0YVBvc3RGYWN0b3J5JywgJyRsb2NhdGlvbiddO1xuICAgICAgICByZXR1cm4gUG9zdExpc3RDb250cm9sbGVyO1xuICAgIH0oKSk7XG4gICAgbW9kdWxlRmlyc3REZW1vLlBvc3RMaXN0Q29udHJvbGxlciA9IFBvc3RMaXN0Q29udHJvbGxlcjtcbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2RlbW9Nb2R1bGUnKVxuICAgICAgICAuY29udHJvbGxlcignUG9zdExpc3RDb250cm9sbGVyJywgUG9zdExpc3RDb250cm9sbGVyKTtcbn0pKG1vZHVsZUZpcnN0RGVtbyB8fCAobW9kdWxlRmlyc3REZW1vID0ge30pKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVBvc3RMaXN0Q29udHJvbGxlci5qcy5tYXBcbnZhciBtb2R1bGVGaXJzdERlbW87XG4oZnVuY3Rpb24gKG1vZHVsZUZpcnN0RGVtbykge1xuICAgICd1c2Ugc3RyaWN0JztcbiAgICB2YXIgUG9zdFZpZXdDb250cm9sbGVyID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gUG9zdFZpZXdDb250cm9sbGVyKERhdGFQb3N0RmFjdG9yeSwgJGxvY2F0aW9uLCAkcm91dGVQYXJhbXMpIHtcbiAgICAgICAgICAgIHRoaXMuRGF0YVBvc3RGYWN0b3J5ID0gRGF0YVBvc3RGYWN0b3J5O1xuICAgICAgICAgICAgdGhpcy4kbG9jYXRpb24gPSAkbG9jYXRpb247XG4gICAgICAgICAgICB0aGlzLiRyb3V0ZVBhcmFtcyA9ICRyb3V0ZVBhcmFtcztcbiAgICAgICAgICAgIHRoaXMucG9zdElkID0gJHJvdXRlUGFyYW1zLmlkO1xuICAgICAgICAgICAgdGhpcy5nZXRQb3N0KCk7XG4gICAgICAgIH1cbiAgICAgICAgUG9zdFZpZXdDb250cm9sbGVyLnByb3RvdHlwZS5nZXRQb3N0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIHRoaXMuRGF0YVBvc3RGYWN0b3J5LmdldFBvc3QodGhpcy5wb3N0SWQpLnRoZW4oZnVuY3Rpb24gKHJlcykge1xuICAgICAgICAgICAgICAgIF90aGlzLnBvc3QgPSByZXM7XG4gICAgICAgICAgICAgICAgX3RoaXMuZ2V0Q29tbWVudHMoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICBQb3N0Vmlld0NvbnRyb2xsZXIucHJvdG90eXBlLmFkZE5ld0xpa2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLnBvc3QubGlrZXMgPSAodGhpcy5wb3N0Lmxpa2VzICsgMSkgfHwgMDtcbiAgICAgICAgICAgIHRoaXMuRGF0YVBvc3RGYWN0b3J5LnNhdmVQb3N0KHRoaXMucG9zdCkudGhlbihmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgUG9zdFZpZXdDb250cm9sbGVyLnByb3RvdHlwZS5nZXRDb21tZW50cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICB0aGlzLkRhdGFQb3N0RmFjdG9yeS5nZXRDb21tZW50cyh0aGlzLnBvc3RJZCkudGhlbihmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMucG9zdC5jb21tZW50cyA9IHJlcy5yZXZlcnNlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgUG9zdFZpZXdDb250cm9sbGVyLnByb3RvdHlwZS5zYXZlQ29tbWVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICB0aGlzLmNvbW1lbnQuY3JlYXRlZE9uID0gbmV3IERhdGUoKTtcbiAgICAgICAgICAgIHRoaXMuY29tbWVudC5wb3N0SWQgPSB0aGlzLnBvc3RJZDtcbiAgICAgICAgICAgIHRoaXMuRGF0YVBvc3RGYWN0b3J5LnNhdmVDb21tZW50KHRoaXMuY29tbWVudCkudGhlbihmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMucG9zdC5jb21tZW50cy5wdXNoKHJlcyk7XG4gICAgICAgICAgICAgICAgX3RoaXMuY29tbWVudCA9IG51bGw7XG4gICAgICAgICAgICAgICAgLy90aGlzLiRsb2NhdGlvbi5wYXRoKCcvcG9zdHMnKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICBQb3N0Vmlld0NvbnRyb2xsZXIucHJvdG90eXBlLmxvYWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBhbGVydCgpO1xuICAgICAgICB9O1xuICAgICAgICBQb3N0Vmlld0NvbnRyb2xsZXIuJGluamVjdCA9IFsnRGF0YVBvc3RGYWN0b3J5JywgJyRsb2NhdGlvbicsICckcm91dGVQYXJhbXMnXTtcbiAgICAgICAgcmV0dXJuIFBvc3RWaWV3Q29udHJvbGxlcjtcbiAgICB9KCkpO1xuICAgIG1vZHVsZUZpcnN0RGVtby5Qb3N0Vmlld0NvbnRyb2xsZXIgPSBQb3N0Vmlld0NvbnRyb2xsZXI7XG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdkZW1vTW9kdWxlJylcbiAgICAgICAgLmNvbnRyb2xsZXIoJ1Bvc3RWaWV3Q29udHJvbGxlcicsIFBvc3RWaWV3Q29udHJvbGxlcik7XG59KShtb2R1bGVGaXJzdERlbW8gfHwgKG1vZHVsZUZpcnN0RGVtbyA9IHt9KSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1Qb3N0Vmlld0NvbnRyb2xsZXIuanMubWFwXG52YXIgbW9kdWxlRmlyc3REZW1vO1xuKGZ1bmN0aW9uIChtb2R1bGVGaXJzdERlbW8pIHtcbiAgICAndXNlIHN0cmljdCc7XG4gICAgdmFyIEZvY3VzID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gRm9jdXMoKSB7XG4gICAgICAgICAgICB0aGlzLnJlc3RyaWN0ID0gJ0EnO1xuICAgICAgICB9XG4gICAgICAgIEZvY3VzLmluc3RhbmNlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBGb2N1cztcbiAgICAgICAgfTtcbiAgICAgICAgRm9jdXMucHJvdG90eXBlLmxpbmsgPSBmdW5jdGlvbiAoc2NvcGUsIGVsZW1lbnRzLCBhdHRycykge1xuICAgICAgICAgICAgY29uc29sZS5sb2coYXR0cnMpO1xuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgZWxlbWVudHNbMF0uZm9jdXMoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gRm9jdXM7XG4gICAgfSgpKTtcbiAgICBtb2R1bGVGaXJzdERlbW8uRm9jdXMgPSBGb2N1cztcbiAgICBhbmd1bGFyLm1vZHVsZSgnZGVtb01vZHVsZScpXG4gICAgICAgIC5kaXJlY3RpdmUoJ2ZvY3VzJywgRm9jdXMuaW5zdGFuY2UpO1xufSkobW9kdWxlRmlyc3REZW1vIHx8IChtb2R1bGVGaXJzdERlbW8gPSB7fSkpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Rm9jdXNJbnB1dC5qcy5tYXBcbnZhciBtb2R1bGVGaXJzdERlbW87XG4oZnVuY3Rpb24gKG1vZHVsZUZpcnN0RGVtbykge1xuICAgICd1c2Ugc3RyaWN0JztcbiAgICB2YXIgUHJvZ3Jlc3NiYXIgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBQcm9ncmVzc2JhcigpIHtcbiAgICAgICAgICAgIHRoaXMuc2NvcGUgPSB7XG4gICAgICAgICAgICAgICAgJ3Nob3dQcm9ncmVzcyc6ICc9J1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRoaXMucmVzdHJpY3QgPSAnRSc7XG4gICAgICAgICAgICAvL3RlbXBsYXRlPSc8ZGl2IGNsYXNzPVwicHJvZ3Jlc3NcIj48ZGl2IGNsYXNzPVwicHJvZ3Jlc3MtYmFyXCIgcm9sZT1cInByb2dyZXNzYmFyXCIgYXJpYS12YWx1ZW5vdz1cInt7IHZhbHVlIH19XCIgYXJpYS12YWx1ZW1pbj1cIjBcIiBhcmlhLXZhbHVlbWF4PVwiMTAwXCIgc3R5bGU9XCJ3aWR0aDoge3sgdmFsdWUgfX0lO1wiPjxzcGFuIGNsYXNzPVwic3Itb25seVwiPjYwJSBDb21wbGV0ZTwvc3Bhbj48L2Rpdj48L2Rpdj48ZGl2PjxzcGFuPnt7IHZhbHVlIH19JSBDb21wbGV0ZWQ8L3NwYW4+PC9kaXY+JztcbiAgICAgICAgICAgIHRoaXMudGVtcGxhdGVVcmwgPSAnYXBwL2RpcmVjdGl2ZXMvcHJvZ3Jlc3NCYXIuaHRtbCc7XG4gICAgICAgIH1cbiAgICAgICAgUHJvZ3Jlc3NiYXIuaW5zdGFuY2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb2dyZXNzYmFyO1xuICAgICAgICB9O1xuICAgICAgICBQcm9ncmVzc2Jhci5wcm90b3R5cGUubGluayA9IGZ1bmN0aW9uIChzY29wZSwgZWxlbWVudHMsIGF0dHJzKSB7XG4gICAgICAgICAgICBzY29wZS52YWx1ZSA9IDA7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhzY29wZS5zaG93UHJvZ3Jlc3MpO1xuICAgICAgICAgICAgc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHNjb3BlLiRhcHBseShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzY29wZS52YWx1ZSA+PSAxMDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLnZhbHVlID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBzY29wZS52YWx1ZSA9IHNjb3BlLnZhbHVlICsgMTA7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LCAxMDAwKTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIFByb2dyZXNzYmFyO1xuICAgIH0oKSk7XG4gICAgbW9kdWxlRmlyc3REZW1vLlByb2dyZXNzYmFyID0gUHJvZ3Jlc3NiYXI7XG4gICAgYW5ndWxhci5tb2R1bGUoJ2RlbW9Nb2R1bGUnKVxuICAgICAgICAuZGlyZWN0aXZlKCdwcm9ncmVzc0JhcicsIFByb2dyZXNzYmFyLmluc3RhbmNlKTtcbn0pKG1vZHVsZUZpcnN0RGVtbyB8fCAobW9kdWxlRmlyc3REZW1vID0ge30pKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVByb2dyZXNzQmFyRGlyZWN0aXZlLmpzLm1hcFxudmFyIG1vZHVsZUZpcnN0RGVtbztcbihmdW5jdGlvbiAobW9kdWxlRmlyc3REZW1vKSB7XG4gICAgdmFyIGRvbWFpbjtcbiAgICAoZnVuY3Rpb24gKGRvbWFpbikge1xuICAgICAgICB2YXIgQ29tbWVudCA9IChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBmdW5jdGlvbiBDb21tZW50KHBvc3RJZCwgY29tbWVudElkLCBib2R5LCBjcmVhdGVkT24sIGF1dGhvcikge1xuICAgICAgICAgICAgICAgIHRoaXMucG9zdElkID0gcG9zdElkO1xuICAgICAgICAgICAgICAgIHRoaXMuY29tbWVudElkID0gY29tbWVudElkO1xuICAgICAgICAgICAgICAgIHRoaXMuYm9keSA9IGJvZHk7XG4gICAgICAgICAgICAgICAgdGhpcy5jcmVhdGVkT24gPSBjcmVhdGVkT247XG4gICAgICAgICAgICAgICAgdGhpcy5hdXRob3IgPSBhdXRob3I7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gQ29tbWVudDtcbiAgICAgICAgfSgpKTtcbiAgICAgICAgZG9tYWluLkNvbW1lbnQgPSBDb21tZW50O1xuICAgIH0pKGRvbWFpbiA9IG1vZHVsZUZpcnN0RGVtby5kb21haW4gfHwgKG1vZHVsZUZpcnN0RGVtby5kb21haW4gPSB7fSkpO1xufSkobW9kdWxlRmlyc3REZW1vIHx8IChtb2R1bGVGaXJzdERlbW8gPSB7fSkpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Y29tbWVudC5qcy5tYXBcbnZhciBtb2R1bGVGaXJzdERlbW87XG4oZnVuY3Rpb24gKG1vZHVsZUZpcnN0RGVtbykge1xuICAgIHZhciBkb21haW47XG4gICAgKGZ1bmN0aW9uIChkb21haW4pIHtcbiAgICAgICAgdmFyIFBvc3QgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZnVuY3Rpb24gUG9zdChwb3N0SWQsIHBvc3ROYW1lLCBwb3N0RGVzY3JpcHRpb24sIHBvc3RTaG9ydERlc2NyaXB0aW9uLCBwdWJsaXNoRGF0ZSwgbGlrZXMsIGF1dGhvciwgaW1hZ2VVcmwsIGNvbW1lbnRzLCB0YWdzKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wb3N0SWQgPSBwb3N0SWQ7XG4gICAgICAgICAgICAgICAgdGhpcy5wb3N0TmFtZSA9IHBvc3ROYW1lO1xuICAgICAgICAgICAgICAgIHRoaXMucG9zdERlc2NyaXB0aW9uID0gcG9zdERlc2NyaXB0aW9uO1xuICAgICAgICAgICAgICAgIHRoaXMucG9zdFNob3J0RGVzY3JpcHRpb24gPSBwb3N0U2hvcnREZXNjcmlwdGlvbjtcbiAgICAgICAgICAgICAgICB0aGlzLnB1Ymxpc2hEYXRlID0gcHVibGlzaERhdGU7XG4gICAgICAgICAgICAgICAgdGhpcy5saWtlcyA9IGxpa2VzO1xuICAgICAgICAgICAgICAgIHRoaXMuYXV0aG9yID0gYXV0aG9yO1xuICAgICAgICAgICAgICAgIHRoaXMuaW1hZ2VVcmwgPSBpbWFnZVVybDtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbW1lbnRzID0gY29tbWVudHM7XG4gICAgICAgICAgICAgICAgdGhpcy50YWdzID0gdGFncztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBQb3N0O1xuICAgICAgICB9KCkpO1xuICAgICAgICBkb21haW4uUG9zdCA9IFBvc3Q7XG4gICAgfSkoZG9tYWluID0gbW9kdWxlRmlyc3REZW1vLmRvbWFpbiB8fCAobW9kdWxlRmlyc3REZW1vLmRvbWFpbiA9IHt9KSk7XG59KShtb2R1bGVGaXJzdERlbW8gfHwgKG1vZHVsZUZpcnN0RGVtbyA9IHt9KSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1wb3N0LmpzLm1hcFxudmFyIG1vZHVsZUZpcnN0RGVtbztcbihmdW5jdGlvbiAobW9kdWxlRmlyc3REZW1vKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuICAgIHZhciBEYXRhUG9zdEZhY3RvcnkgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBEYXRhUG9zdEZhY3RvcnkoJGh0dHApIHtcbiAgICAgICAgICAgIHRoaXMuJGh0dHAgPSAkaHR0cDtcbiAgICAgICAgfVxuICAgICAgICBEYXRhUG9zdEZhY3RvcnkucHJvdG90eXBlLmdldFBvc3RzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuJGh0dHBcbiAgICAgICAgICAgICAgICAuZ2V0KCdodHRwOi8vMTA0LjEzMS4yOC4yMjQ6MzAwMC9wb3N0cy8nKVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5kYXRhO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIERhdGFQb3N0RmFjdG9yeS5wcm90b3R5cGUuc2F2ZVBvc3QgPSBmdW5jdGlvbiAocG9zdCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuJGh0dHBcbiAgICAgICAgICAgICAgICAucG9zdCgnaHR0cDovLzEwNC4xMzEuMjguMjI0OjMwMDAvcG9zdHMvJywgcG9zdClcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICBEYXRhUG9zdEZhY3RvcnkucHJvdG90eXBlLnVwZGF0ZVBvc3QgPSBmdW5jdGlvbiAocG9zdCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuJGh0dHBcbiAgICAgICAgICAgICAgICAucHV0KCdodHRwOi8vMTA0LjEzMS4yOC4yMjQ6MzAwMC9wb3N0cy8nICsgcG9zdC5wb3N0SWQsIHBvc3QpXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGE7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgRGF0YVBvc3RGYWN0b3J5LnByb3RvdHlwZS5nZXRQb3N0ID0gZnVuY3Rpb24gKGlkKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy4kaHR0cFxuICAgICAgICAgICAgICAgIC5nZXQoJ2h0dHA6Ly8xMDQuMTMxLjI4LjIyNDozMDAwL3Bvc3RzLycgKyBpZClcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICBEYXRhUG9zdEZhY3RvcnkucHJvdG90eXBlLmdldENvbW1lbnRzID0gZnVuY3Rpb24gKHBvc3RJZCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuJGh0dHBcbiAgICAgICAgICAgICAgICAuZ2V0KCdodHRwOi8vMTA0LjEzMS4yOC4yMjQ6MzAwMC9jb21tZW50cy8/cG9zdElkPScgKyBwb3N0SWQpXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGE7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgRGF0YVBvc3RGYWN0b3J5LnByb3RvdHlwZS5zYXZlQ29tbWVudCA9IGZ1bmN0aW9uIChjb21tZW50KSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy4kaHR0cFxuICAgICAgICAgICAgICAgIC5wb3N0KCdodHRwOi8vMTA0LjEzMS4yOC4yMjQ6MzAwMC9jb21tZW50cy8nLCBjb21tZW50KVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5kYXRhO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIERhdGFQb3N0RmFjdG9yeS5wcm90b3R5cGUuZGVsZXRlUG9zdCA9IGZ1bmN0aW9uIChpZCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuJGh0dHBcbiAgICAgICAgICAgICAgICAuZGVsZXRlKCdodHRwOi8vMTA0LjEzMS4yOC4yMjQ6MzAwMC9wb3N0cy8nICsgaWQpXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGE7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgRGF0YVBvc3RGYWN0b3J5LiRpbmplY3QgPSBbJyRodHRwJ107XG4gICAgICAgIHJldHVybiBEYXRhUG9zdEZhY3Rvcnk7XG4gICAgfSgpKTtcbiAgICBtb2R1bGVGaXJzdERlbW8uRGF0YVBvc3RGYWN0b3J5ID0gRGF0YVBvc3RGYWN0b3J5O1xuICAgIGZ1bmN0aW9uIGZhY3RvcnkoJGh0dHApIHtcbiAgICAgICAgcmV0dXJuIG5ldyBEYXRhUG9zdEZhY3RvcnkoJGh0dHApO1xuICAgIH1cbiAgICBmYWN0b3J5LiRpbmplY3QgPSBbXCIkaHR0cFwiXTtcbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2RlbW9Nb2R1bGUnKVxuICAgICAgICAuZmFjdG9yeSgnRGF0YVBvc3RGYWN0b3J5JywgZmFjdG9yeSk7XG59KShtb2R1bGVGaXJzdERlbW8gfHwgKG1vZHVsZUZpcnN0RGVtbyA9IHt9KSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1kYXRhUG9zdEZhY3RvcnkuanMubWFwXG52YXIgbW9kdWxlRmlyc3REZW1vO1xuKGZ1bmN0aW9uIChtb2R1bGVGaXJzdERlbW8pIHtcbiAgICAndXNlIHN0cmljdCc7XG4gICAgZnVuY3Rpb24gU3RvcmVTZWFyY2goKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoaXRlbXMsIHNlYXJjaCkge1xuICAgICAgICAgICAgdmFyIGZpbHRlcmVkID0gW107XG4gICAgICAgICAgICBpZiAoIXNlYXJjaCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBpdGVtcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChpdGVtcywgZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICBpZiAoYW5ndWxhci5sb3dlcmNhc2UoaXRlbS5wb3N0TmFtZSkuaW5kZXhPZihhbmd1bGFyLmxvd2VyY2FzZShzZWFyY2gpKSAhPSAtMSkge1xuICAgICAgICAgICAgICAgICAgICBmaWx0ZXJlZC5wdXNoKGl0ZW0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGZpbHRlcmVkO1xuICAgICAgICB9O1xuICAgIH1cbiAgICBtb2R1bGVGaXJzdERlbW8uU3RvcmVTZWFyY2ggPSBTdG9yZVNlYXJjaDtcbiAgICBhbmd1bGFyLm1vZHVsZShcImRlbW9Nb2R1bGVcIikuZmlsdGVyKFwic3RvcmVTZWFyY2hcIiwgU3RvcmVTZWFyY2gpO1xufSkobW9kdWxlRmlyc3REZW1vIHx8IChtb2R1bGVGaXJzdERlbW8gPSB7fSkpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dGFnRmlsdGVyLmpzLm1hcFxudmFyIG1vZHVsZUZpcnN0RGVtbztcbihmdW5jdGlvbiAobW9kdWxlRmlyc3REZW1vKSB7XG4gICAgdmFyIGNvbW1vbjtcbiAgICAoZnVuY3Rpb24gKGNvbW1vbikge1xuICAgICAgICBhbmd1bGFyLm1vZHVsZSgnY29tbW9uLnNlcnZpY2VzJywgWyduZ1Jlc291cmNlJ10pO1xuICAgIH0pKGNvbW1vbiA9IG1vZHVsZUZpcnN0RGVtby5jb21tb24gfHwgKG1vZHVsZUZpcnN0RGVtby5jb21tb24gPSB7fSkpO1xufSkobW9kdWxlRmlyc3REZW1vIHx8IChtb2R1bGVGaXJzdERlbW8gPSB7fSkpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Y29tbW9uLnNlcnZpY2VzLmpzLm1hcFxudmFyIG1vZHVsZUZpcnN0RGVtbztcbihmdW5jdGlvbiAobW9kdWxlRmlyc3REZW1vKSB7XG4gICAgdmFyIGNvbW1vbjtcbiAgICAoZnVuY3Rpb24gKGNvbW1vbikge1xuICAgICAgICAndXNlIHN0cmljdCc7XG4gICAgICAgIHZhciBEYXRhUG9zdFNlcnZpY2UgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZnVuY3Rpb24gRGF0YVBvc3RTZXJ2aWNlKCRyZXNvdXJjZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuJHJlc291cmNlID0gJHJlc291cmNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgRGF0YVBvc3RTZXJ2aWNlLnByb3RvdHlwZS5nZXRQb3N0UmVzb3VyY2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuJHJlc291cmNlKFwiaHR0cDovLzEwNC4xMzEuMjguMjI0OjMwMDAvcG9zdHMvOmlkXCIpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIERhdGFQb3N0U2VydmljZS4kaW5qZWN0ID0gWyckcmVzb3VyY2UnXTtcbiAgICAgICAgICAgIHJldHVybiBEYXRhUG9zdFNlcnZpY2U7XG4gICAgICAgIH0oKSk7XG4gICAgICAgIGNvbW1vbi5EYXRhUG9zdFNlcnZpY2UgPSBEYXRhUG9zdFNlcnZpY2U7XG4gICAgICAgIGFuZ3VsYXJcbiAgICAgICAgICAgIC5tb2R1bGUoJ2NvbW1vbi5zZXJ2aWNlcycpXG4gICAgICAgICAgICAuc2VydmljZSgnRGF0YVBvc3RTZXJ2aWNlJywgRGF0YVBvc3RTZXJ2aWNlKTtcbiAgICB9KShjb21tb24gPSBtb2R1bGVGaXJzdERlbW8uY29tbW9uIHx8IChtb2R1bGVGaXJzdERlbW8uY29tbW9uID0ge30pKTtcbn0pKG1vZHVsZUZpcnN0RGVtbyB8fCAobW9kdWxlRmlyc3REZW1vID0ge30pKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWRhdGFQb3N0U2VydmljZXMuanMubWFwIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9